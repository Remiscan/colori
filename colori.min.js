export default class Couleur{constructor(e){this.r=null,this.g=null,this.b=null,this.a=null;var t=(e,t=1)=>e||(0===e?0:t);if(e instanceof Couleur)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a;else if(!Array.isArray(e)||3!=e.length&&4!=e.length){if("string"!=typeof e)throw`Couleur objects can only be created from a string, an array of parsed values, or another Couleur object ; this is not one: ${JSON.stringify(e)}`;var r=Couleur.matchSyntax(e.trim());switch(r.id){case"hex":this.hex=[r.data[1],r.data[2],r.data[3],t(r.data[4],"ff")];break;case"rgb":this.rgb=[r.data[1],r.data[2],r.data[3],t(r.data[4])];break;case"hsl":this.hsl=[r.data[1],r.data[2],r.data[3],t(r.data[4])];break;case"hwb":this.hwb=[r.data[1],r.data[2],r.data[3],t(r.data[4])];break;case"lab":this.lab=[r.data[1],r.data[2],r.data[3],t(r.data[4])];break;case"lch":this.lch=[r.data[1],r.data[2],r.data[3],t(r.data[4])];break;case"color":this.setColor(r.data[1],[r.data[2],r.data[3],r.data[4],t(r.data[5])]);break;default:throw`${JSON.stringify(e)} is not a valid color format`}}else[this.r,this.g,this.b]=Couleur.toGamut("srgb",e.slice(0,3),"srgb",{method:"naive"}),this.a=Math.max(0,Math.min(t(e[3]),1))}static makeInstance(e){return e instanceof Couleur?e:new Couleur(e)}static matchSyntax(e){const t=e.slice(0,3);let r;if("#"===t.slice(0,1))r=Couleur.formats[0];else switch(t){case"rgb":r=Couleur.formats[1];break;case"hsl":r=Couleur.formats[2];break;case"hwb":r=Couleur.formats[3];break;case"lab":r=Couleur.formats[4];break;case"lch":r=Couleur.formats[5];break;case"col":r=Couleur.formats[6];break;default:r=Couleur.formats[7]}for(const l of r.syntaxes){var a=e.match(l);if(null!=a&&a[0]===e){if("name"===r.id){if("transparent"===e)return{id:"rgb",data:[null,0,0,0,0]};var s=Couleur.couleursNommees,u=e.toLowerCase();if(u in s)return Couleur.matchSyntax("#"+s[u])}return{id:r.id,data:a}}}throw`${JSON.stringify(e)} is not a valid color format`}static parse(t,r=null,{clamp:e=!0}={}){if("a"===r){if(new RegExp("^"+Couleur.vPer+"$").test(t))return e?Math.max(0,Math.min(parseFloat(t)/100,1)):parseFloat(t)/100;if(new RegExp("^"+Couleur.vNum+"$").test(t))return e?Math.max(0,Math.min(t,1)):parseFloat(t);throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if(["r","g","b"].includes(r)){if(new RegExp("^"+Couleur.vPer+"$").test(t))return e?Math.max(0,Math.min(parseFloat(t)/100,1)):parseFloat(t)/100;if(new RegExp("^"+Couleur.vNum+"$").test(t))return e?Math.max(0,Math.min(t/255,1)):t/255;throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if(["h","cieh"].includes(r)){let e=parseFloat(t);if(new RegExp("^"+Couleur.vNum+"$").test(t))return Utils.angleToRange(e);if(new RegExp("^"+Couleur.vAng+"$").test(t)){if("deg"!==String(t).slice(-3))if("grad"===String(t).slice(-4))e=360*e/400;else if("rad"===String(t).slice(-3))e=180*e/Math.PI;else{if("turn"!==String(t).slice(-4))throw`Invalid angle value: ${JSON.stringify(t)}`;e*=360}return Utils.angleToRange(e)}throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if(["s","l","w","bk","ciel"].includes(r)){if(new RegExp("^"+Couleur.vPer+"$").test(t))return e?Math.max(0,Math.min(parseFloat(t)/100,1)):parseFloat(t)/100;throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if(["ciea","cieb"].includes(r)){if(new RegExp("^"+Couleur.vNum+"$").test(t))return parseFloat(t);throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if("ciec"===r){if(new RegExp("^"+Couleur.vNum+"$").test(t))return e?Math.max(0,t):parseFloat(t);throw`Invalid ${JSON.stringify(r)} value: ${JSON.stringify(t)}`}if(new RegExp("^"+Couleur.vPer+"$").test(t))return parseFloat(t)/100;if(new RegExp("^"+Couleur.vNum+"$").test(t))return parseFloat(t);throw`Invalid arbitrary value: ${JSON.stringify(t)}`}static unparse(e,t,{precision:r=0}={}){switch(t){case"r":case"g":case"b":return null===r?`${255*e}`:`${Math.round(10**r*255*e)/10**r}`;case"s":case"l":case"w":case"bk":case"ciel":return null===r?`${100*e}%`:`${Math.round(10**r*100*e)/10**r}%`;case"a":return null===r?`${e}`:`${Math.round(10**Math.max(r,2)*e)/10**Math.max(r,2)}`;default:return null===r?`${e}`:`${Math.round(10**r*e)/10**r}`}}set(r,e,t){t=Couleur.getSpace(t),e=e.map((e,t)=>Couleur.parse(r[t],e));[this.r,this.g,this.b]=Couleur.convert(t,"srgb",e);var a,s;this.a=Couleur.parse((a=r[3],s=1,a||(0===a?0:s)),"a")}expr(e,{precision:r=0,clamp:t=!0}={}){var a="string"==typeof e?e.replace("color-",""):e,a=Couleur.getSpace(a);let s=this.valuesTo(a);t&&(s=Couleur.toGamut(a,s,a));var u=Couleur.unparse(this.a,"a",{precision:r});if(s=[...s,u],"color"===e.slice(0,5)){let e=`color(${a.id}`;for(var[l,n]of Object.entries(s))if(Number(l)===s.length-1){if(1<=u)break;e+=` / ${u}`}else e+=` ${null===r?n:Math.round(10**r*n)/10**r}`;return e+=")",e}const o=Couleur.propertiesOf(e);var[i,h,c]=o.map((e,t)=>Couleur.unparse(s[t],e,{precision:r}));switch(e){case"rgb":case"rgba":case"hsl":case"hsla":return 3<e.length&&"a"===e.slice(-1)||u<1?`${e}(${i}, ${h}, ${c}, ${u})`:`${e}(${i}, ${h}, ${c})`;default:return u<1?`${e}(${i} ${h} ${c} / ${u})`:`${e}(${i} ${h} ${c})`}}static makeExpr(e,t,r,a){var s="string"==typeof e?e.replace("color-",""):e,t=[...Couleur.convert(r,s,t.slice(0,3)),t[3]];return new Couleur(t).expr(e,a)}get values(){return[this.r,this.g,this.b]}get name(){if(1!==this.a)return 0===this.a?"transparent":null;var e,t,r=Couleur.couleursNommees,[a,s,u]=[255*this.r,255*this.g,255*this.b];for([e,t]of Object.entries(r)){var[l,n,o]=[parseInt(`${t[0]}${t[1]}`,16),parseInt(`${t[2]}${t[3]}`,16),parseInt(`${t[4]}${t[5]}`,16)];if(Math.abs(l-a)+Math.abs(n-s)+Math.abs(o-u)<255*.02)return e}return null}get exactName(){if(1!==this.a)return 0===this.a?"transparent":null;var e,t,r=Couleur.couleursNommees,a=this.hex.slice(1);for([e,t]of Object.entries(r))if(t===a)return e;return null}set hex(e){let t,r,a,s;t=e[0],t=1===t.length?t.repeat(2):t,t=parseInt(t,16),r=e[1],r=1===r.length?r.repeat(2):r,r=parseInt(r,16),a=e[2],a=1===a.length?a.repeat(2):a,a=parseInt(a,16),s=e[3]||"ff",s=1===s.length?s.repeat(2):s,s=parseInt(s,16)/255,this.rgb=[t,r,a,s]}set hexa(e){this.hex=e}get hex(){var e=[...Couleur.toGamut("srgb",this.values),this.a].map(e=>Utils.pad(Math.round(255*e).toString(16)));return this.a<1?`#${e[0]}${e[1]}${e[2]}${e[3]}`:`#${e[0]}${e[1]}${e[2]}`}set rgb(e){this.set(e,["r","g","b"],"srgb")}set rgba(e){this.rgb=e}get rgb(){return this.expr("rgb",{precision:2})}get rgba(){return this.rgb}set hsl(e){this.set(e,["h","s","l"],"hsl")}set hsla(e){this.hsl=e}get hsl(){return this.expr("hsl",{precision:2})}get hsla(){return this.hsl}set hwb(e){this.set(e,["h","w","bk"],"hwb")}get hwb(){return this.expr("hwb",{precision:2})}set lab(e){this.set(e,["ciel","ciea","cieb"],"lab")}get lab(){return this.expr("lab",{precision:2})}set lch(e){this.set(e,["ciel","ciec","cieh"],"lch")}get lch(){return this.expr("lch",{precision:2})}setColor(e,t){let r=t.slice(0,3);t=t[3];switch(e){case"srgb":case"display-p3":case"a98-rgb":case"prophoto-rgb":case"rec2020":r=r.map(e=>(e=>Math.max(0,Math.min(e,1)))(e));case"xyz":r=Couleur.convert(e,"srgb",r);break;default:throw`The ${JSON.stringify(e)} color space is not supported`}t=[...r,t];return this.set(t,[null,null,null],"srgb")}set h(e){const[,t,r]=this.valuesTo("hsl"),a=[...Couleur.propertiesOf("hsl"),"a"];this.hsl=[e,t,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set hue(e){this.h=e}set s(e){const[t,,r]=this.valuesTo("hsl"),a=[...Couleur.propertiesOf("hsl"),"a"];this.hsl=[t,e,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set saturation(e){this.s=e}set l(e){const[t,r]=this.valuesTo("hsl"),a=[...Couleur.propertiesOf("hsl"),"a"];this.hsl=[t,r,e,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set lightness(e){this.l=e}set w(e){const[t,,r]=this.valuesTo("hwb"),a=[...Couleur.propertiesOf("hwb"),"a"];this.hwb=[t,e,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set whiteness(e){this.w=e}set bk(e){const[t,r]=this.valuesTo("hwb"),a=[...Couleur.propertiesOf("hwb"),"a"];this.hwb=[t,r,e,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set blackness(e){this.bk=e}set ciel(e){const[,t,r]=this.valuesTo("lab"),a=[...Couleur.propertiesOf("lch"),"a"];this.lab=[e,t,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set CIElightness(e){this.ciel=e}set ciea(e){const[t,,r]=this.valuesTo("lab"),a=[...Couleur.propertiesOf("lab"),"a"];this.lab=[t,e,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set cieb(e){const[t,r]=this.valuesTo("lab"),a=[...Couleur.propertiesOf("lab"),"a"];this.lab=[t,r,e,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set ciec(e){const[t,,r]=this.valuesTo("lch"),a=[...Couleur.propertiesOf("lch"),"a"];this.lch=[t,e,r,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set CIEchroma(e){this.ciec=e}set cieh(e){const[t,r]=this.valuesTo("lch"),a=[...Couleur.propertiesOf("lch"),"a"];this.lch=[t,r,e,this.a].map((e,t)=>Couleur.unparse(e,a[t]))}set CIEhue(e){this.cieh=e}get red(){return this.r}get green(){return this.g}get blue(){return this.b}get alpha(){return this.a}get opacity(){return this.a}get h(){return this.valuesTo("hsl")[0]}get hue(){return this.h}get s(){return this.valuesTo("hsl")[1]}get saturation(){return this.s}get l(){return this.valuesTo("hsl")[2]}get lightness(){return this.l}get w(){return this.valuesTo("hwb")[1]}get whiteness(){return this.w}get bk(){return this.valuesTo("hwb")[2]}get whiteness(){return this.w}get ciel(){return this.valuesTo("lab")[0]}get CIElightness(){return this.ciel}get ciea(){return this.valuesTo("lab")[1]}get cieb(){return this.valuesTo("lab")[2]}get ciec(){return this.valuesTo("lch")[1]}get CIEchroma(){return this.ciec}get cieh(){return this.valuesTo("lch")[2]}get CIEhue(){return this.cieh}get luminance(){if(this.a<1)throw"The luminance of a transparent color would be meaningless";return Utils.luminance(this.values)}static convert(e,t,r){if((e.id||e)===(t.id||t))return r;var a=Couleur.getSpace(e),s=Couleur.getSpace(t);let u;const l=new Graph(Couleur.colorSpaces);try{u=l.shortestPath(a.id,s.id)}catch(e){switch(e){case`Node ${a.id} does not exist`:throw`${JSON.stringify(a.id)} is not a supported color space`;case`Node ${s.id} does not exist`:throw`${JSON.stringify(s.id)} is not a supported color space`;case`No path found from ${a.id} to ${s.id}`:throw`Conversion from ${JSON.stringify(a.id)} space to ${JSON.stringify(s.id)} space is impossible`;default:throw e}}let n=r;for(;1<u.length;){var o=`${u.shift()}_to_${u[0]}`.replace(/-/g,"");Utils[o]||console.log(o),n=Utils[o](n)}return n}valuesTo(e,{clamp:t=!1}={}){e=Couleur.getSpace(e);let r=Couleur.convert("srgb",e,this.values);return t&&(r=Couleur.toGamut(e,r)),r}static inGamut(e,t,r="srgb",{tolerance:a=1e-4}={}){const s=Couleur.getSpace(e),u=Couleur.convert(r,s,t);return u.every((e,t)=>e>=s.gamut[t][0]-a&&e<=s.gamut[t][1]+a)}inGamut(e,t){return Couleur.inGamut(e,this.values,"srgb",t)}static toGamut(e,a,s="srgb",{method:t="chroma"}={}){const u=Couleur.getSpace(e);s=Couleur.getSpace(s);if(Couleur.inGamut(u,a,s,{tolerance:0}))return a;let l,n;if("naive"===t){n=u;const r=Couleur.convert(s,n,a);l=r.map((e,t)=>Math.max(u.gamut[t][0],Math.min(e,u.gamut[t][1])))}else{n=Couleur.getSpace("lch");let e=Couleur.convert(s,n,a);let t=0,r=e[1];for(e[1]=e[1]/2;.01<r-t;){var o=Couleur.toGamut(u,e,n,{method:"naive"});Couleur.distance(o,e,{method:"CIEDE2000"})<2.01?t=e[1]:r=e[1],e[1]=(t+r)/2}l=Couleur.toGamut(u,e,n,{method:"naive"})}return Couleur.convert(n,s,l)}toGamut(e){return Couleur.toGamut(e,this.values,"srgb")}change(e,t,{action:r=null}={}){var a="replace"===r,s="scale"===r,r=s?Couleur.parse(t):Couleur.parse(t,e,{clamp:!1});const u=new Couleur(this);t=this[e];return u[e]=a?r:s?t*r:t+r,u}replace(e,t){return this.change(e,t,{action:"replace"})}scale(e,t){return this.change(e,t,{action:"scale"})}complement(){return this.change("h",180)}negative(){return new Couleur(`rgb(${255*(1-this.r)}, ${255*(1-this.g)}, ${255*(1-this.b)}, ${this.a})`)}invert(){return this.negative()}greyscale(){var e=255*this.replace("a",1).luminance;return new Couleur(`rgb(${e}, ${e}, ${e}, ${this.a})`)}grayscale(){return this.greyscale()}sepia(){var e=Math.min(.393*this.r+.769*this.g+.189*this.b,1),t=Math.min(.349*this.r+.686*this.g+.168*this.b,1),r=Math.min(.272*this.r+.534*this.g+.131*this.b,1);return new Couleur(`rgb(${255*e}, ${255*t}, ${255*r}, ${this.a})`)}static blend(e,t,r){var a=Couleur.makeInstance(e);const s=Couleur.makeInstance(t);if(null!=r&&(s.a=Couleur.parse(r,"a")),0===s.a)return a;if(1===s.a)return s;e=s.a+a.a*(1-s.a),t=(s.r*s.a+a.r*a.a*(1-s.a))/e,r=(s.g*s.a+a.g*a.a*(1-s.a))/e,a=(s.b*s.a+a.b*a.a*(1-s.a))/e;return new Couleur([t,r,a,e])}static blendAll(...e){if(e.length<2)throw"You need at least 2 colors to blend";var t=e.shift(),r=e.shift(),r=Couleur.blend(t,r);return 0===e.length?r:Couleur.blendAll(r,...e)}blend(e,t){return Couleur.blend(this,e,t)}blendAll(...e){return Couleur.blendAll(this,...e)}static unblend(e,t,r){var a=Couleur.makeInstance(e);const s=Couleur.makeInstance(t);if(null!=r&&(s.a=Couleur.parse(r,"a")),1===s.a)throw`Overlay color ${JSON.stringify(s.rgb)} isn't transparent, so the background it was blended onto could have been any color`;if(0===s.a)return a;if(a.a<s.a)return null;if(a.a===s.a)return Couleur.same(a,s)?new Couleur([0,0,0,0]):null;e=(a.a-s.a)/(1-s.a),t=(a.r*a.a-s.r*s.a)/(e*(1-s.a)),r=(a.g*a.a-s.g*s.a)/(e*(1-s.a)),a=(a.b*a.a-s.b*s.a)/(e*(1-s.a));if(!Couleur.inGamut("srgb",[t,r,a],"srgb",{tolerance:1/255}))return null;a=Couleur.toGamut("srgb",[t,r,a],"srgb",{method:"naive"});return new Couleur([...a,e])}static unblendAll(...e){if(e.length<2)throw"You need at least 2 colors to unblend";var t=e.shift(),r=e.shift(),r=Couleur.unblend(t,r);return 0===e.length?r:Couleur.unblendAll(r,...e)}unblend(e,t){return Couleur.unblend(this,e,t)}unblendAll(...e){return Couleur.unblendAll(this,...e)}static whatToBlend(e,t,r=[],{ignoreTransparent:a=!1}={}){const s=Couleur.makeInstance(e),u=Couleur.makeInstance(t);let l=[];var n=e=>{var t=(u.r*u.a-s.r*s.a*(1-e))/e,r=(u.g*u.a-s.g*s.a*(1-e))/e,a=(u.b*u.a-s.b*s.a*(1-e))/e;if(!Couleur.inGamut("srgb",[t,r,a],"srgb",{tolerance:1/255}))throw"This color doesn't exist";a=Couleur.toGamut("srgb",[t,r,a],"srgb",{method:"naive"});return new Couleur([...a,e])};const o=[r].flat();t=0<o.length?o.filter(e=>0<e&&e<1):Array.from({length:9},(e,t)=>(t+1)/10);if(u.a<s.a)return null;if(u.a>s.a)if(1===u.a)l.push(u);else if(0===s.a)l.push(u);else{r=(u.a-s.a)/(1-s.a);try{l.push(n(r))}catch(e){return null}}else if(u.a===s.a)if(0===u.a)l.push(new Couleur("transparent"));else if(u.a<1){if(!Couleur.same(u,s))return null;l.push(new Couleur("transparent"))}else{Couleur.same(u,s)&&l.push(new Couleur("transparent"));for(const h of t)try{l.push(n(h))}catch(e){continue}l.push(u)}let i=0<o.length?l.filter(e=>o.includes(e.a)):l;return a&&(i=i.filter(e=>0<e)),0===i.length?null:1===i.length?i[0]:i}whatToBlend(e,t){return Couleur.whatToBlend(this,e,t)}static contrast(e,t,{method:r="WCAG2"}={}){var a=Couleur.makeInstance(t);if(a.a<1)throw"The contrast with a transparent background color would be meaningless";let s=Couleur.makeInstance(e);switch(s.a<1&&(s=Couleur.blend(a,s)),r.toLowerCase()){case"wcag3":case"sapc":case"apca":return Utils.APCAcontrast(s.values,a.values);default:return Utils.WCAG2contrast(s.values,a.values)}}contrast(e,t){return Couleur.contrast(this,e,t)}bestColorScheme(e="background"){if("text"===e){var t=Math.abs(Couleur.contrast(this,"black",{method:"apca"}));return Math.abs(Couleur.contrast(this,"white",{method:"apca"}))<=t?"dark":"light"}t=Math.abs(Couleur.contrast("black",this,{method:"apca"}));return Math.abs(Couleur.contrast("white",this,{method:"apca"}))<=t?"light":"dark"}improveContrast(e,t,{lower:r=!1,colorScheme:a=null,method:s="WCAG2"}={}){const u=Couleur.makeInstance(e);var l=u.valuesTo("lab");const n=this.valuesTo("lab");e=Couleur.contrast(this,u,s);let o;if(o=t<e?-1:e<t?1:0,o<0&&!1===r||0===o)return this;r=a||(l[0]<n[0]?"dark":"light"),a=Couleur.contrast(u,"black",s),l=Couleur.contrast(u,"white",s);const i=0<o?Math.abs(a)>=t:Math.abs(a)<=t,h=0<o?Math.abs(l)>=t:Math.abs(l)<=t;let c;if(i&&!h)c=-1;else if(h&&!i)c=1;else{if(!h&&!i)return"light"===r?new Couleur("black"):new Couleur("white");c=!("light"===r&&0<o)&&("light"===r&&o<0||"dark"===r&&0<o)?1:-1}let f=0<c?n[0]:0,g=0<c?1:n[0];for(;1e-4<g-f;){var d=(f+g)/2;const p=n;p[0]=d;var b=Couleur.contrast(Couleur.convert("lab","srgb",p),u,s);(0<o?Math.abs(b)<t:Math.abs(b)>t)?0<c?f=d:g=d:0<c?g=d:f=d,n[0]=d}r=new Couleur(Couleur.convert("lab","srgb",n));return Math.abs(Couleur.contrast(r,u,s))<t&&(0<c?n[0]=g:n[0]=f),new Couleur(Couleur.convert("lab","srgb",n))}static distance(e,t,{method:r="CIEDE2000"}={}){const a=Couleur.makeInstance(e),s=Couleur.makeInstance(t),[u,l]=[a,s].map(e=>e.valuesTo("lab"));return"CIEDE2000"!==r?u.reduce((e,t,r)=>e+(t-l[r])**2):Utils.CIEDE2000(u,l)}distance(e,t){return Couleur.distance(this,e,t)}static same(e,t,r=1){return!(Couleur.distance(e,t)>r)}same(e){return Couleur.same(this,e)}static gradient(e,t,r=5,a="lch"){const s=Couleur.makeInstance(e),u=Couleur.makeInstance(t),l=Math.max(1,r),n=[...Couleur.propertiesOf(a),"a"],o=Couleur.getSpace(a),i=[...s.valuesTo(o),s.a],h=[...u.valuesTo(o),u.a],c=n.map((e,t)=>{let r;switch(e){case"h":case"cieh":var a=((h[t]-i[t])%360+360)%360,s=((i[t]-h[t])%360+360)%360;r=(a<=s?a:-s)/l;break;default:r=(h[t]-i[t])/l}return r}),f=[i];for(let t=1;t<l;t++){let r=f[t-1],e=n.map((e,t)=>{t=r[t]+c[t];return["h","cieh"].includes(e)?Utils.angleToRange(t):t});var g=e[3];e=Couleur.toGamut(o,e.slice(0,3),o),e=[...e,g],f.push(e)}return[...f.map(e=>new Couleur(Couleur.convert(o,"srgb",e))),u]}gradient(e,t,r){return Couleur.gradient(this,e,t,r)}static propertiesOf(e){switch(e){case"rgb":case"rgba":return["r","g","b"];case"hsl":case"hsla":return["h","s","l"];case"hwb":case"hwba":return["h","w","bk"];case"lab":case"laba":return["ciel","ciea","cieb"];case"lch":case"lcha":return["ciel","ciec","cieh"];default:return[]}}static get properties(){return["a","r","g","b","h","s","l","w","bk","ciel","ciea","cieb","ciec","cieh"]}static get colorSpaces(){return[{id:"srgb",whitepoint:"d65",CSSformat:"rgb",gamut:[[0,1],[0,1],[0,1]],links:["lin_srgb","hsl"]},{id:"lin_srgb",links:["srgb","d65xyz"]},{id:"hsl",whitepoint:"d65",CSSformat:"hsl",gamut:[[0,360],[0,1],[0,1]],links:["srgb","hwb"]},{id:"hwb",whitepoint:"d65",CSSformat:"hwb",gamut:[[0,360],[0,1],[0,1]],links:["hsl"]},{id:"lab",whitepoint:"d50",CSSformat:"lab",gamut:[[0,4],[-1/0,1/0],[-1/0,1/0]],links:["xyz","lch"]},{id:"lch",whitepoint:"d50",CSSformat:"lch",gamut:[[0,4],[0,1/0],[0,360]],links:["lab"]},{id:"xyz",whitepoint:"d50",CSSformat:"color",gamut:[[-1/0,1/0],[-1/0,1/0],[-1/0,1/0]],links:["lab","d65xyz","lin_prophoto-rgb"]},{id:"d65xyz",whitepoint:"d65",links:["xyz","lin_srgb","lin_display-p3","lin_a98-rgb","lin_rec2020"]},{id:"display-p3",whitepoint:"d65",CSSformat:"color",gamut:[[0,1],[0,1],[0,1]],links:["lin_display-p3"]},{id:"lin_display-p3",links:["display-p3","d65xyz"]},{id:"a98-rgb",whitepoint:"d65",CSSformat:"color",gamut:[[0,1],[0,1],[0,1]],links:["lin_a98-rgb"]},{id:"lin_a98-rgb",links:["a98-rgb","d65xyz"]},{id:"prophoto-rgb",whitepoint:"d50",CSSformat:"color",gamut:[[0,1],[0,1],[0,1]],links:["lin_prophoto-rgb"]},{id:"lin_prophoto-rgb",links:["prophoto-rgb","xyz"]},{id:"rec2020",whitepoint:"d65",CSSformat:"color",gamut:[[0,1],[0,1],[0,1]],links:["lin_rec2020"]},{id:"lin_rec2020",links:["rec2020","d65xyz"]}]}static getSpace(e){if("string"==typeof e.id)return e;const t="rgb"===e||"rgba"===e?"srgb":"hsla"===e?"hsl":e;return Couleur.colorSpaces.find(e=>e.id==t)}static get formats(){return[{id:"hex",syntaxes:[/^#([a-fA-F0-9]{1})([a-fA-F0-9]{1})([a-fA-F0-9]{1})$/,/^#([a-fA-F0-9]{1})([a-fA-F0-9]{1})([a-fA-F0-9]{1})([a-fA-F0-9]{1})$/,/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/]},{id:"rgb",syntaxes:[new RegExp(`^rgba?\\((${Couleur.vNum}), ?(${Couleur.vNum}), ?(${Couleur.vNum})\\)$`),new RegExp(`^rgba?\\((${Couleur.vNum}), ?(${Couleur.vNum}), ?(${Couleur.vNum}), ?(${Couleur.vNP})\\)$`),new RegExp(`^rgba?\\((${Couleur.vPer}), ?(${Couleur.vPer}), ?(${Couleur.vPer})\\)$`),new RegExp(`^rgba?\\((${Couleur.vPer}), ?(${Couleur.vPer}), ?(${Couleur.vPer}), ?(${Couleur.vNP})\\)$`),new RegExp(`^rgba?\\((${Couleur.vNum}) (${Couleur.vNum}) (${Couleur.vNum})\\)$`),new RegExp(`^rgba?\\((${Couleur.vNum}) (${Couleur.vNum}) (${Couleur.vNum}) ?\\/ ?(${Couleur.vNP})\\)$`),new RegExp(`^rgba?\\((${Couleur.vPer}) (${Couleur.vPer}) (${Couleur.vPer})\\)$`),new RegExp(`^rgba?\\((${Couleur.vPer}) (${Couleur.vPer}) (${Couleur.vPer}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"hsl",syntaxes:[new RegExp(`^hsla?\\((${Couleur.vAng}), ?(${Couleur.vPer}), ?(${Couleur.vPer})\\)$`),new RegExp(`^hsla?\\((${Couleur.vAng}), ?(${Couleur.vPer}), ?(${Couleur.vPer}), ?(${Couleur.vNP})\\)$`),new RegExp(`^hsla?\\((${Couleur.vAng}) (${Couleur.vPer}) (${Couleur.vPer})\\)$`),new RegExp(`^hsla?\\((${Couleur.vAng}) (${Couleur.vPer}) (${Couleur.vPer}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"hwb",syntaxes:[new RegExp(`^hwb\\((${Couleur.vAng}) (${Couleur.vPer}) (${Couleur.vPer})\\)$`),new RegExp(`^hwb\\((${Couleur.vAng}) (${Couleur.vPer}) (${Couleur.vPer}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"lab",syntaxes:[new RegExp(`^lab\\((${Couleur.vPer}) (${Couleur.vNum}) (${Couleur.vNum})\\)$`),new RegExp(`^lab\\((${Couleur.vPer}) (${Couleur.vNum}) (${Couleur.vNum}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"lch",syntaxes:[new RegExp(`^lch\\((${Couleur.vPer}) (${Couleur.vNum}) (${Couleur.vAng})\\)$`),new RegExp(`^lch\\((${Couleur.vPer}) (${Couleur.vNum}) (${Couleur.vAng}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"color",syntaxes:[new RegExp(`^color\\(([a-zA-Z0-9_-]+?) (${Couleur.vNum}) (${Couleur.vNum}) (${Couleur.vNum})\\)$`),new RegExp(`^color\\(([a-zA-Z0-9_-]+?) (${Couleur.vNum}) (${Couleur.vNum}) (${Couleur.vNum}) ?\\/ ?(${Couleur.vNP})\\)$`)]},{id:"name",syntaxes:[/^[A-Za-z]+$/]}]}static get vNum(){return"(?:\\-|\\+)?(?:[0-9]+(?:\\.[0-9]+)?|\\.[0-9]+)(?:(?:e|E)(?:\\-|\\+)?[0-9]+)?"}static get vPer(){return Couleur.vNum+"%"}static get vNP(){return Couleur.vNum+"%?"}static get vAng(){return Couleur.vNum+"(?:deg|grad|rad|turn)?"}static get vProp(){return Couleur.properties.join("|")}static get couleursNommees(){return{aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}}}const Utils={pad:function(e){return e.length<2?`0${e}`:e},angleToRange:function(e){let t=e;for(;t<0;)t+=360;for(;360<t;)t-=360;return t},pRound:function(e,t=5){let r="number"==typeof e?e:Number(e);return Number(parseFloat(r.toPrecision(t)))},srgb_to_lin_srgb:function(e){return e.map(e=>Math.abs(e)<.04045?e/12.92:(Math.sign(e)||1)*Math.pow((Math.abs(e)+.055)/1.055,2.4))},lin_srgb_to_srgb:function(e){return e.map(e=>.0031308<Math.abs(e)?(Math.sign(e)||1)*(1.055*Math.pow(Math.abs(e),1/2.4)-.055):12.92*e)},lin_srgb_to_d65xyz:function(e){var[t,r,e]=e;return[.41239079926595934*t+.357584339383878*r+.1804807884018343*e,.21263900587151027*t+.715168678767756*r+.07219231536073371*e,.01933081871559182*t+.11919477979462598*r+.9505321522496607*e]},d65xyz_to_lin_srgb:function(e){var[t,r,e]=e;return[3.2409699419045226*t+-1.537383177570094*r+-.4986107602930034*e,-.9692436362808796*t+1.8759675015077202*r+.04155505740717559*e,.05563007969699366*t+-.20397695888897652*r+1.0569715142428786*e]},srgb_to_hsl:function(e){var[t,r,a]=e,s=Math.max(t,r,a),e=Math.min(t,r,a),u=s-e,e=(s+e)/2;let l;if(0==u)l=0;else switch(s){case t:l=(r-a)/u;break;case r:l=(a-t)/u+2;break;case a:l=(t-r)/u+4}for(l*=60;l<0;)l+=360;for(;360<l;)l-=360;let n;return n=0==e||1==e?0:e<=.5?u/(2*e):u/(2-2*e),[l,n,e]},hsl_to_srgb:function(e){const[t,r,a]=e,s=r*Math.min(a,1-a),u=e=>(e+t/30)%12;e=e=>a-s*Math.max(Math.min(u(e)-3,9-u(e),1),-1);return[e(0),e(8),e(4)]},hsl_to_hwb:function(e){var[t,r,e]=e;let a;r=e+r*Math.min(e,1-e);return a=0===r?0:2-2*e/r,[t,(1-a)*r,1-r]},hwb_to_hsl:function(e){var[t,r,e]=e;let a=r,s=e;1<r+e&&(a=r/(r+e),s=e/(r+e));let u;r=1-s;u=1===s?0:1-a/r;let l;e=r-r*u/2;return l=0==e||1==e?0:(r-e)/Math.min(e,1-e),[t,l,e]},displayp3_to_lin_displayp3:function(e){return this.srgb_to_lin_srgb(e)},lin_displayp3_to_displayp3:function(e){return this.lin_srgb_to_srgb(e)},lin_displayp3_to_d65xyz:function(e){var[t,r,e]=e;return[.4865709486482162*t+.26566769316909306*r+.1982172852343625*e,.2289745640697488*t+.6917385218365064*r+.079286914093745*e,0*t+.04511338185890264*r+1.043944368900976*e]},d65xyz_to_lin_displayp3:function(e){var[t,r,e]=e;return[2.493496911941425*t+-.9313836179191239*r+-.40271078445071684*e,-.8294889695615747*t+1.7626640603183463*r+.023624685841943577*e,.03584583024378447*t+-.07617238926804182*r+.9568845240076872*e]},prophotorgb_to_lin_prophotorgb:function(e){return e.map(e=>Math.abs(e)<=.03125?e/16:(Math.sign(e)||1)*Math.pow(e,1.8))},lin_prophotorgb_to_prophotorgb:function(e){return e.map(e=>Math.abs(e)>=1/512?(Math.sign(e)||1)*Math.pow(Math.abs(e),1/1.8):16*e)},lin_prophotorgb_to_xyz:function(e){var[t,r,e]=e;return[.7977604896723027*t+.13518583717574031*r+.0313493495815248*e,.2880711282292934*t+.7118432178101014*r+8565396060525902e-20*e,0*t+0*r+.8251046025104601*e]},xyz_to_lin_prophotorgb:function(e){var[t,r,e]=e;return[1.3457989731028281*t+-.25558010007997534*r+-.05110628506753401*e,-.5446224939028347*t+1.5082327413132781*r+.02053603239147973*e,0*t+0*r+1.2119675456389454*e]},a98rgb_to_lin_a98rgb:function(e){return e.map(e=>(Math.sign(e)||1)*Math.pow(Math.abs(e),563/256))},lin_a98rgb_to_a98rgb:function(e){return e.map(e=>(Math.sign(e)||1)*Math.pow(Math.abs(e),256/563))},lin_a98rgb_to_d65xyz:function(e){var[t,r,e]=e;return[.5766690429101305*t+.1855582379065463*r+.1882286462349947*e,.29734497525053605*t+.6273635662554661*r+.07529145849399788*e,.02703136138641234*t+.07068885253582723*r+.9913375368376388*e]},d65xyz_to_lin_a98rgb:function(e){var[t,r,e]=e;return[2.0415879038107465*t+-.5650069742788596*r+-.34473135077832956*e,-.9692436362808795*t+1.8759675015077202*r+.04155505740717557*e,.013444280632031142*t+-.11836239223101838*r+1.0151749943912054*e]},rec2020_to_lin_rec2020:function(e){return e.map(e=>Math.abs(e)<.08124285829863151?e/4.5:(Math.sign(e)||1)*Math.pow(Math.abs(e)+1.09929682680944-1,1/.45))},lin_rec2020_to_rec2020:function(e){const t=1.09929682680944;return e.map(e=>.018053968510807<Math.abs(e)?(Math.sign(e)||1)*(t*Math.pow(Math.abs(e),.45)-(t-1)):4.5*e)},lin_rec2020_to_d65xyz:function(e){var[t,r,e]=e;return[.6369580483012914*t+.14461690358620832*r+.1688809751641721*e,.2627002120112671*t+.6779980715188708*r+.05930171646986196*e,0*t+.028072693049087428*r+1.060985057710791*e]},d65xyz_to_lin_rec2020:function(e){var[t,r,e]=e;return[1.7166511879712674*t+-.35567078377639233*r+-.25336628137365974*e,-.6666843518324892*t+1.6164812366349395*r+.01576854581391113*e,.017639857445310783*t+-.042770613257808524*r+.9421031212354738*e]},xyz_to_lab:function(e){const r=[.96422,1,.82521],[t,a,s]=e.map((e,t)=>e/r[t]);var[u,l,e]=[t,a,s].map(e=>(e=>216/24389<e?Math.cbrt(e):(24389/27*e+16)/116)(e));return[(116*l-16)/100,500*(u-l),200*(l-e)]},lab_to_xyz:function(e){var t=216/24389,r=24389/27;const a=[.96422,1,.82521];var[s,u,l]=e,e=(16+(s*=100))/116,u=u/500+e,l=e-l/200;const n=t<u**3?u**3:(116*u-16)/r,o=8<s?((16+s)/116)**3:s/r,i=t<l**3?l**3:(116*l-16)/r;return[n,o,i].map((e,t)=>e*a[t])},lab_to_lch:function(e){var[t,r,a]=e,e=Math.sqrt(r**2+a**2);let s=180*Math.atan2(a,r)/Math.PI;for(;s<0;)s+=360;for(;360<s;)s-=360;return[t,e,s]},lch_to_lab:function(e){var[t,r,e]=e;return[t,r*Math.cos(e*Math.PI/180),r*Math.sin(e*Math.PI/180)]},d65xyz_to_xyz:function(e){var[t,r,e]=e;return[1.0479298208405488*t+.022946793341019088*r+-.05019222954313557*e,.029627815688159344*t+.990434484573249*r+-.01707382502938514*e,-.009243058152591178*t+.015055144896577895*r+.7518742899580008*e]},xyz_to_d65xyz:function(e){var[t,r,e]=e;return[.9554734527042182*t+-.023098536874261423*r+.0632593086610217*e,-.028369706963208136*t+1.0099954580058226*r+.021041398966943008*e,.012314001688319899*t+-.020507696433477912*r+1.3303659366080753*e]},luminance:function(e){e=Utils.srgb_to_lin_srgb(e);return.2126*e[0]+.7152*e[1]+.0722*e[2]},WCAG2contrast:function(e,t){e=Utils.luminance(e),t=Utils.luminance(t);return(Math.max(e,t)+.05)/(Math.min(e,t)+.05)},APCAcontrast:function(e,t){const a=[.2126729,.7151522,.072175];let[r,s]=[e,t].map(e=>(e=>e.reduce((e,t,r)=>e+Math.pow(t,2.4)*a[r],0))(e));[r,s]=[r,s].map(e=>.03<e?e:e+Math.pow(.03-e,1.45));if(Math.abs(r-s)<5e-4)return 0;let u;var l=(e,t,r,a)=>1.25*(Math.pow(e,r)-Math.pow(t,a)),e=12.82051282051282;return u=s>r?(t=l(s,r,.55,.58))<.001?0:t<.078?t*(1-.06*e):t-.06:-.001<(l=l(s,r,.62,.57))?0:-.078<l?l*(1-.06*e):l+.06,100*u},CIEDE2000:function([e,t,r],[a,s,u]){var l=100*e,n=100*a,o=(Math.sqrt(t**2+r**2)+Math.sqrt(s**2+u**2))/2,e=.5*(1-Math.sqrt(o**7/(o**7+25**7))),a=(1+e)*t,o=(1+e)*s,t=Math.sqrt(a**2+r**2),e=Math.sqrt(o**2+u**2);let i=0===t?0:180*Math.atan2(r,a)/Math.PI,h=0===e?0:180*Math.atan2(u,o)/Math.PI;for(;i<0;)i+=360;for(;360<i;)i-=360;for(;h<0;)h+=360;for(;360<h;)h-=360;s=n-l,r=e-t,a=t*e==0?0:Math.abs(h-i)<=180?h-i:180<h-i?h-i-360:h-i+360,u=2*Math.sqrt(t*e)*Math.sin(Math.PI/180*(a/2)),o=(l+n)/2,a=(t+e)/2,l=t*e==0?i+h:Math.abs(h-i)<=180?(i+h)/2:360<=i+h?(i+h-360)/2:(i+h+360)/2,n=1-.17*Math.cos(Math.PI/180*(l-30))+.24*Math.cos(Math.PI/180*(2*l))+.32*Math.cos(Math.PI/180*(3*l+6))-.2*Math.cos(Math.PI/180*(4*l-63)),t=30*Math.exp(-1*((l-275)/25)**2),e=2*Math.sqrt(a**7/(a**7+25**7)),l=1+.015*(o-50)**2/Math.sqrt(20+(o-50)**2),o=1+.045*a,n=1+.015*a*n,e=-1*Math.sin(Math.PI/180*(2*t))*e;return Math.sqrt((s/l)**2+(r/o)**2+(u/n)**2+r/o*e*(u/n))},findShortestPath:function(e,t,r){if(t===r)return[];const[a,s]=[t,r].map(t=>e.find(e=>e.id===t));if(void 0===a)throw`Node ${JSON.stringify(t)} does not exist`;if(void 0===s)throw`Node ${JSON.stringify(r)} does not exist`;const u=[a];let l=!(a.visited=!0);e:for(;0<u.length;){const o=u.shift();if(o.id===s.id){l=!0;break e}for(const i of o.links){const h=e.find(e=>e.id===i);!1===h.visited&&(h.visited=!0,h.predecessorID=o.id,u.push(h))}}if(!l)throw`No path found from ${JSON.stringify(t)} to ${JSON.stringify(r)}`;const n=[];n.push(s.id);let o=s;for(;null!=o.predecessorID;)n.push(o.predecessorID),o=e.find(e=>e.id===o.predecessorID);return n.reverse()}};class GraphNode{constructor(e){this.id=e.id,this.links=e.links,this.visited=!1,this.predecessorID=null}visit(){this.visited=!0}follow(e){this.predecessorID=e.id}}class Graph{constructor(e){this.nodes=e.map(e=>new GraphNode(e))}getNode(t){var e=this.nodes.find(e=>e.id===t);if(void 0===e)throw`Node ${JSON.stringify(t)} does not exist`;return e}shortestPath(e,t){if(e===t)return[];const r=this.getNode(e);var a=this.getNode(t);const s=[r];r.visit();let u=!1;e:for(;0<s.length;){const n=s.shift();if(n.id===a.id){u=!0;break e}for(const o of n.links){const i=this.getNode(o);!1===i.visited&&(i.visit(),i.follow(n),s.push(i))}}if(!u)throw`No path found from ${JSON.stringify(r.id)} to ${JSON.stringify(a.id)}`;const l=[a.id];let n=a;for(;null!=n.predecessorID;)l.push(n.predecessorID),n=this.getNode(n.predecessorID);return l.reverse()}}export{Utils,Graph};